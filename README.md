# 🧠 Smart Gemini FileSystem Agent

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Gemini](https://img.shields.io/badge/AI-Google%20Gemini-orange.svg)](https://ai.google.dev/)
[![MCP](https://img.shields.io/badge/Protocol-MCP-purple.svg)](https://modelcontextprotocol.io/)

> Интеллектуальный AI-агент для работы с файловой системой на базе Google Gemini с поддержкой Model Context Protocol (MCP)

## ✨ Особенности

### 🧠 **Интеллектуальные возможности**
- **Анализ намерений** - понимает что вы хотите сделать из естественного языка
- **Контекстная память** - помнит предыдущие действия и файлы
- **Умная категоризация** - автоматически группирует инструменты по функциональности
- **Контекстные ссылки** - понимает "1", "2" как ссылки на предыдущие варианты

### 🔧 **Файловые операции**
- ✅ **Создание** файлов и папок
- ✅ **Чтение** файлов (текст, медиа, множественное чтение)
- ✅ **Удаление** файлов и папок (безопасно, только в рабочей директории)
- ✅ **Перемещение** и переименование
- ✅ **Поиск** файлов по паттернам
- ✅ **Редактирование** файлов

### 🌐 **Веб-возможности**
- 🔍 **Поиск в интернете** через DuckDuckGo
- ⬇️ **Загрузка контента** по URL
- 📊 **Парсинг веб-страниц**

### 🎨 **Красивый интерфейс**
- Rich терминальный интерфейс с цветами и таблицами
- Категоризированное отображение инструментов
- Примеры умных запросов
- Детальная информация о статусе системы

## 🚀 Быстрый старт

### Требования
- Python 3.8+
- Google API Key для Gemini
- Node.js (для MCP серверов)
- uv/uvx (для Python MCP серверов)

### Установка

1. **Клонируйте репозиторий:**
```bash
git clone https://github.com/maks-mk/smart-gemini-agent.git
cd smart-gemini-agent
```

2. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

3. **Настройте переменные окружения:**
```bash
# Создайте файл .env
echo "GOOGLE_API_KEY=your_gemini_api_key_here" > .env
```

4. **Установите MCP серверы:**
```bash
# Для веб-поиска
pip install duckduckgo-mcp-server

# Для загрузки контента
pip install mcp-server-fetch
```

### Запуск

```bash
python gemini_agent.py
```

## 💬 Примеры использования

### Файловые операции
```bash
# Создание файлов
"создай файл readme.md с описанием проекта"
"сделай новый файл config.json"

# Чтение файлов
"прочитай файл config.py"
"покажи содержимое readme.md"

# Удаление файлов (безопасно!)
"удали файл old_backup.txt"
"удали папку temp"

# Поиск файлов
"найди все Python файлы"
"покажи файлы с расширением .txt"
```

### Веб-операции
```bash
# Поиск в интернете
"найди в интернете информацию о FastAPI"
"поищи последние новости Python"

# Загрузка контента
"скачай документацию с python.org"
"загрузи данные с api.example.com"
```

### Контекстные команды
```bash
# После получения вариантов от агента
Агент: "1. Переименовать файл 2. Переместить файл 3. Удалить файл"
Вы: "1"  # Агент поймет что вы выбрали первый вариант
```

## 🛠️ Системные команды

| Команда | Описание |
|---------|----------|
| `/help` | Показать справку по командам |
| `/tools` | Показать все доступные инструменты |
| `/status` | Показать статус системы |
| `/clear` | Очистить экран |
| `/tree [путь]` | Показать дерево файлов |
| `/history` | Показать историю команд |
| `/thread <имя>` | Переключить контекст |
| `/export` | Экспорт истории диалога |
| `/quit` | Выйти из программы |

## 🏗️ Архитектура

### Основные компоненты

```
┌─────────────────────────────────────┐
│         Gemini Agent                │
├─────────────────────────────────────┤
│  • Intent Analysis                  │
│  • Context Memory                   │
│  • Smart Tool Selection             │
└─────────────────────────────────────┘
                  │
┌─────────────────────────────────────┐
│         MCP Client                  │
├─────────────────────────────────────┤
│  • FileSystem Server               │
│  • DuckDuckGo Server               │
│  • Fetch Server                    │
└─────────────────────────────────────┘
                  │
┌─────────────────────────────────────┐
│      Local Tools                   │
├─────────────────────────────────────┤
│  • SafeDeleteFileTool              │
│  • SafeDeleteDirectoryTool         │
└─────────────────────────────────────┘
```

### Ключевые классы

- **`FileSystemAgent`** - Основной класс агента
- **`SafeDeleteFileTool`** - Безопасное удаление файлов
- **`SafeDeleteDirectoryTool`** - Безопасное удаление папок
- **`RichInteractiveChat`** - Терминальный интерфейс

## 🔒 Безопасность

### Защита файловой системы
- ✅ Все операции только внутри рабочей директории
- ✅ Проверка и нормализация путей
- ✅ Защита от path traversal атак
- ✅ Проверка прав доступа

### Примеры защиты
```python
# ❌ Попытка удаления вне рабочей директории
"удали /etc/passwd"
# Результат: "❌ ОШИБКА: Попытка удаления файла вне рабочей директории"

# ✅ Безопасное удаление внутри рабочей директории
"удали temp_file.txt"
# Результат: "✅ УСПЕХ: Файл temp_file.txt успешно удален"
```

## ⚙️ Конфигурация

### Переменные окружения

| Переменная | Описание | По умолчанию |
|------------|----------|--------------|
| `GOOGLE_API_KEY` | API ключ для Google Gemini | **Обязательно** |
| `FILESYSTEM_PATH` | Рабочая директория | Текущая директория |
| `GEMINI_MODEL` | Модель Gemini | `gemini-2.0-flash` |
| `TEMPERATURE` | Температура модели | `0.0` |

### Пример .env файла
```env
GOOGLE_API_KEY=your_api_key_here
FILESYSTEM_PATH=/path/to/your/workspace
GEMINI_MODEL=gemini-2.0-flash
TEMPERATURE=0.0
```

## 📊 Статистика

### Возможности агента
- 🔧 **19 инструментов** (17 MCP + 2 локальных)
- 🧠 **Контекстная память** до 20 файлов
- 🎯 **Анализ намерений** с регулярными выражениями
- 📁 **9 категорий** инструментов

### Производительность
- ⏱️ **Время инициализации**: ~12-15 секунд
- ⏱️ **Время ответа**: 2-15 секунд (зависит от сложности)
- 🎯 **Точность понимания**: значительно улучшена
- 💯 **Безопасность**: 100% - не выходит за пределы рабочей директории

## 🤝 Участие в разработке

### Как внести вклад

1. Fork репозитория
2. Создайте feature branch (`git checkout -b feature/amazing-feature`)
3. Commit изменения (`git commit -m 'Add amazing feature'`)
4. Push в branch (`git push origin feature/amazing-feature`)
5. Откройте Pull Request

### Разработка

```bash
# Клонирование для разработки
git clone https://github.com/maks-mk/smart-gemini-agent.git
cd smart-gemini-agent

# Установка в режиме разработки
pip install -e .

# Запуск тестов
python -m pytest tests/

# Запуск с отладкой
python gemini_agent.py --debug
```

## 📝 Changelog

### v2.0.0 (Latest)
- ✅ Добавлены локальные инструменты удаления
- ✅ Улучшена контекстная память
- ✅ Обновлен интерфейс /help
- ✅ Добавлена категория веб-операций

### v1.0.0
- 🎉 Первый релиз с базовой функциональностью
- 🧠 Анализ намерений пользователя
- 🔧 Интеграция с MCP серверами
- 🎨 Rich терминальный интерфейс

## 📄 Лицензия

Этот проект лицензирован под MIT License - см. файл [LICENSE](LICENSE) для деталей.

## 👥 Авторы

**Создатель и основной разработчик:** [Максим Макаров](https://github.com/maks-mk)

Подробнее об авторах и участниках см. в [AUTHORS.md](AUTHORS.md).

## 🙏 Благодарности

- [Google Gemini](https://ai.google.dev/) - за мощную языковую модель
- [Model Context Protocol](https://modelcontextprotocol.io/) - за стандарт интеграции инструментов
- [Rich](https://github.com/Textualize/rich) - за красивый терминальный интерфейс
- [LangChain](https://langchain.com/) - за фреймворк для AI агентов

## 📞 Поддержка

- 🐛 **Баги**: [GitHub Issues](https://github.com/maks-mk/smart-gemini-agent/issues)
- 💡 **Идеи**: [GitHub Discussions](https://github.com/maks-mk/smart-gemini-agent/discussions)
- 📧 **Email**: maks.mk.dev@gmail.com

---

<div align="center">

**Сделано с ❤️ для разработчиков**

[⭐ Поставьте звезду](https://github.com/maks-mk/smart-gemini-agent) • [🐛 Сообщить о баге](https://github.com/maks-mk/smart-gemini-agent/issues) • [💡 Предложить идею](https://github.com/maks-mk/smart-gemini-agent/discussions)

</div>